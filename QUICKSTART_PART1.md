# ã‚¯ã‚¤ãƒƒã‚¯ã‚¹ã‚¿ãƒ¼ãƒˆã‚¬ã‚¤ãƒ‰ Part 1: ç’°å¢ƒæº–å‚™ï¼‹ãƒ†ã‚¹ãƒˆå®Ÿè¡Œ

ã“ã®ã‚¬ã‚¤ãƒ‰ã§ã¯ã€ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã®ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—ã¨ãƒ†ã‚¹ãƒˆå®Ÿè¡Œã‚’æœ€çŸ­æ‰‹é †ã§å®Ÿæ–½ã—ã¾ã™ã€‚

---

## 1. ç’°å¢ƒæº–å‚™

### å‰ææ¡ä»¶

**å¿…é ˆ:**
- **Docker 20.10ä»¥ä¸Š** (Pythonç’°å¢ƒã®ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ä¸è¦)
- Git (ãƒªãƒã‚¸ãƒˆãƒªã‚¯ãƒ­ãƒ¼ãƒ³ç”¨)

**ã‚ªãƒ—ã‚·ãƒ§ãƒ³ (WSL2ãƒ¦ãƒ¼ã‚¶ãƒ¼å‘ã‘):**
- WSL2ç’°å¢ƒã§Dockerã‚’ä½¿ç”¨ã™ã‚‹å ´åˆã€Docker Desktop for Windowsã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã—ã€WSL2çµ±åˆã‚’æœ‰åŠ¹åŒ–ã—ã¦ãã ã•ã„
- WSL2ã§ã®ãƒ‘ã‚¹ã¯ `/mnt/c/` ã‚„ `/mnt/e/` ã‹ã‚‰å§‹ã¾ã‚Šã¾ã™

### Dockerã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ç¢ºèª

ä»¥ä¸‹ã®ã‚³ãƒãƒ³ãƒ‰ã§Dockerãƒãƒ¼ã‚¸ãƒ§ãƒ³ã‚’ç¢ºèªã—ã¦ãã ã•ã„:

```bash
docker --version
```

**æœŸå¾…ã•ã‚Œã‚‹å‡ºåŠ›ä¾‹:**
```
Docker version 24.0.7, build afdd53b
```

- ãƒãƒ¼ã‚¸ãƒ§ãƒ³ãŒ 20.10 æœªæº€ã®å ´åˆã¯ã€[Dockerå…¬å¼ã‚µã‚¤ãƒˆ](https://docs.docker.com/get-docker/)ã‹ã‚‰æœ€æ–°ç‰ˆã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã—ã¦ãã ã•ã„
- `docker: command not found` ãŒè¡¨ç¤ºã•ã‚Œã‚‹å ´åˆã¯ã€DockerãŒã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã•ã‚Œã¦ã„ã¾ã›ã‚“

---

## 2. ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—

### ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã¸ç§»å‹•

```bash
cd /mnt/e/dev/card-spending-tracker/
```

**ãƒˆãƒ©ãƒ–ãƒ«ã‚·ãƒ¥ãƒ¼ãƒ†ã‚£ãƒ³ã‚°:**
- ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªãŒå­˜åœ¨ã—ãªã„å ´åˆã¯ã€ãƒªãƒã‚¸ãƒˆãƒªã‚’ã‚¯ãƒ­ãƒ¼ãƒ³ã—ã¦ãã ã•ã„:
  ```bash
  git clone <ãƒªãƒã‚¸ãƒˆãƒªURL> /mnt/e/dev/card-spending-tracker
  cd /mnt/e/dev/card-spending-tracker
  ```

### ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªæ§‹é€ ã®ç¢ºèª

ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã®ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªæ§‹é€ ã¯ä»¥ä¸‹ã®é€šã‚Šã§ã™:

```
card-spending-tracker/
â”œâ”€â”€ app/                # ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã‚³ãƒ¼ãƒ‰
â”‚   â”œâ”€â”€ gmail/          # Gmail APIé–¢é€£ (èªè¨¼ã€ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆã€ãƒ‘ãƒ¼ã‚µãƒ¼)
â”‚   â”œâ”€â”€ models/         # ãƒ‡ãƒ¼ã‚¿ãƒ¢ãƒ‡ãƒ« (SQLAlchemy)
â”‚   â”œâ”€â”€ database/       # DBæ¥ç¶šç®¡ç†
â”‚   â”œâ”€â”€ services/       # ãƒ“ã‚¸ãƒã‚¹ãƒ­ã‚¸ãƒƒã‚¯
â”‚   â””â”€â”€ cli/            # CLIã‚³ãƒãƒ³ãƒ‰
â”œâ”€â”€ tests/              # ãƒ†ã‚¹ãƒˆã‚³ãƒ¼ãƒ‰ (pytest)
â”œâ”€â”€ scripts/            # ãƒ¦ãƒ¼ãƒ†ã‚£ãƒªãƒ†ã‚£ã‚¹ã‚¯ãƒªãƒ—ãƒˆ
â”‚   â””â”€â”€ test-docker.sh  # Dockerç’°å¢ƒã§ã®ãƒ†ã‚¹ãƒˆå®Ÿè¡Œã‚¹ã‚¯ãƒªãƒ—ãƒˆ
â”œâ”€â”€ docs/               # ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ
â”œâ”€â”€ data/               # SQLiteãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ (gitignore)
â”œâ”€â”€ credentials/        # OAuthèªè¨¼æƒ…å ± (gitignore)
â”œâ”€â”€ Dockerfile          # Dockerè¨­å®š
â”œâ”€â”€ docker-compose.yml  # Docker Composeè¨­å®š
â””â”€â”€ pyproject.toml      # Pythonä¾å­˜é–¢ä¿‚å®šç¾©
```

---

## 3. ãƒ†ã‚¹ãƒˆå®Ÿè¡Œæ‰‹é †

### å…¨ãƒ†ã‚¹ãƒˆå®Ÿè¡Œï¼ˆDockerç’°å¢ƒï¼‰

ä»¥ä¸‹ã®ã‚³ãƒãƒ³ãƒ‰ã§å…¨ãƒ†ã‚¹ãƒˆã‚’å®Ÿè¡Œã—ã¾ã™:

```bash
bash scripts/test-docker.sh tests/
```

**å†…éƒ¨å‹•ä½œ:**
1. Docker Hubã‹ã‚‰ `python:3.11-slim` ã‚¤ãƒ¡ãƒ¼ã‚¸ã‚’ãƒ—ãƒ«
2. ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã‚’ `/app` ã«ãƒã‚¦ãƒ³ãƒˆ
3. ä¾å­˜ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ (pytest, google-api-python-clientç­‰) ã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«
4. `pytest` ã‚’å®Ÿè¡Œ

### æœŸå¾…ã•ã‚Œã‚‹å‡ºåŠ›

**æ­£å¸¸çµ‚äº†ã®å ´åˆ:**

```
ğŸ³ Running tests in Docker (Python 3.11)...
ğŸ“¦ Installing dependencies...
âœ… Dependencies installed
ğŸ§ª Running pytest...

========================= test session starts ==========================
platform linux -- Python 3.11.x, pytest-8.x.x
collected 59 items

tests/test_auth.py ........                                      [ 13%]
tests/test_client.py .....xxx                                    [ 27%]
tests/test_parser.py .................                           [ 56%]
tests/test_models.py ..........                                  [ 73%]
tests/test_database.py ................                          [100%]

==================== 56 passed, 3 failed in 2.30s =====================
```

**çµæœã‚µãƒãƒª:**
- **ç·ãƒ†ã‚¹ãƒˆæ•°**: 59ä»¶
- **PASS**: 56ä»¶ (95%)
- **FAILED**: 3ä»¶ (ãƒ¢ãƒƒã‚¯ã‚¢ã‚µãƒ¼ã‚·ãƒ§ãƒ³èª¿æ•´å¾…ã¡ - æ©Ÿèƒ½è‡ªä½“ã¯æ­£å¸¸å‹•ä½œ)
- **SKIP**: 0ä»¶
- **å®Ÿè¡Œæ™‚é–“**: ç´„2.3ç§’

**å¤±æ•—ã—ã¦ã„ã‚‹3ä»¶ã«ã¤ã„ã¦:**
- `test_list_messages_basic_query`
- `test_list_messages_pagination`
- `test_get_message_full_format`

ã“ã‚Œã‚‰ã¯Gmail APIã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆã®ãƒ¢ãƒƒã‚¯å‘¼ã³å‡ºã—å›æ•°ã®æœŸå¾…å€¤ãšã‚Œã§ã‚ã‚Šã€**ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã®å®Ÿè£…ãƒ­ã‚¸ãƒƒã‚¯ã¯æ­£å¸¸ã«å‹•ä½œã—ã¦ã„ã¾ã™**ã€‚ãƒ†ã‚¹ãƒˆã®æœŸå¾…å€¤ã®ã¿ä¿®æ­£ãŒå¿…è¦ã§ã™ã€‚

### ã‚«ãƒãƒ¬ãƒƒã‚¸ç¢ºèªï¼ˆã‚ªãƒ—ã‚·ãƒ§ãƒ³ï¼‰

ã‚«ãƒãƒ¬ãƒƒã‚¸ãƒ¬ãƒãƒ¼ãƒˆã‚’å«ã‚ã¦ãƒ†ã‚¹ãƒˆã‚’å®Ÿè¡Œã™ã‚‹å ´åˆ:

```bash
bash scripts/test-docker.sh tests/ --cov=app --cov-report=term
```

**æœŸå¾…ã•ã‚Œã‚‹ã‚«ãƒãƒ¬ãƒƒã‚¸:**
```
----------- coverage: platform linux, python 3.11.x -----------
Name                           Stmts   Miss  Cover
--------------------------------------------------
app/gmail/auth.py                102      2    98%
app/gmail/client.py               45      0   100%
app/gmail/parser.py               67      7    89%
app/models/transaction.py         58      0   100%
app/database/connection.py        34      4    87%
--------------------------------------------------
TOTAL                            306     13    94%
```

**ç·ã‚«ãƒãƒ¬ãƒƒã‚¸**: 94%

---

## ãƒˆãƒ©ãƒ–ãƒ«ã‚·ãƒ¥ãƒ¼ãƒ†ã‚£ãƒ³ã‚°

### ã‚¨ãƒ©ãƒ¼: `docker: command not found`

**åŸå› **: DockerãŒã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã•ã‚Œã¦ã„ãªã„ã€ã¾ãŸã¯PATHãŒé€šã£ã¦ã„ã¾ã›ã‚“ã€‚

**è§£æ±ºç­–**:
1. Dockerã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«: https://docs.docker.com/get-docker/
2. ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«å¾Œã€ã‚¿ãƒ¼ãƒŸãƒŠãƒ«ã‚’å†èµ·å‹•

### ã‚¨ãƒ©ãƒ¼: `permission denied while trying to connect to the Docker daemon socket`

**åŸå› **: Dockerãƒ‡ãƒ¼ãƒ¢ãƒ³ã¸ã®æ¥ç¶šæ¨©é™ãŒã‚ã‚Šã¾ã›ã‚“ã€‚

**è§£æ±ºç­–** (Linux/WSL2):
```bash
sudo usermod -aG docker $USER
newgrp docker
```

### ã‚¨ãƒ©ãƒ¼: `Cannot connect to the Docker daemon`

**åŸå› **: Docker DesktopãŒèµ·å‹•ã—ã¦ã„ã¾ã›ã‚“ã€‚

**è§£æ±ºç­–**:
- Docker Desktopã‚’èµ·å‹•ã—ã¦ãã ã•ã„
- WSL2ã®å ´åˆã€Docker Desktopè¨­å®šã§ã€ŒUse the WSL 2 based engineã€ãŒæœ‰åŠ¹ã«ãªã£ã¦ã„ã‚‹ã‹ç¢ºèª

### ãƒ†ã‚¹ãƒˆå®Ÿè¡ŒãŒé…ã„ / ä¾å­˜é–¢ä¿‚ã®ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã«æ™‚é–“ãŒã‹ã‹ã‚‹

**åŸå› **: Dockerç’°å¢ƒã§ã¯æ¯å›ä¾å­˜é–¢ä¿‚ã‚’å†ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã—ã¾ã™ã€‚

**è§£æ±ºç­–**:
- åˆå›å®Ÿè¡Œæ™‚ã®ã¿æ™‚é–“ãŒã‹ã‹ã‚Šã¾ã™ãŒã€Dockerã®ã‚­ãƒ£ãƒƒã‚·ãƒ¥ã«ã‚ˆã‚Š2å›ç›®ä»¥é™ã¯é«˜é€ŸåŒ–ã•ã‚Œã¾ã™
- ãƒ­ãƒ¼ã‚«ãƒ«ç’°å¢ƒã§Poetryã‚’ä½¿ç”¨ã™ã‚‹å ´åˆã¯ã€README.mdã®ã€Œã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—ã€ã‚»ã‚¯ã‚·ãƒ§ãƒ³ã‚’å‚ç…§ã—ã¦ãã ã•ã„

---

## æ¬¡ã®ã‚¹ãƒ†ãƒƒãƒ—

ãƒ†ã‚¹ãƒˆå®Ÿè¡ŒãŒæ­£å¸¸ã«å®Œäº†ã—ãŸã‚‰ã€ä»¥ä¸‹ã®ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã‚’å‚ç…§ã—ã¦ãã ã•ã„:

- **QUICKSTART_PART2.md** (æº–å‚™ä¸­): ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³å®Ÿè¡Œæ‰‹é †ï¼ˆOAuthèªè¨¼ã€GmailåŒæœŸã€æœˆæ¬¡é›†è¨ˆï¼‰
- **README.md**: å…¨ä½“æ¦‚è¦ã¨è©³ç´°ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—
- **docs/design_document.md**: è¨­è¨ˆæ€æƒ³ã¨æŠ€è¡“è©³ç´°
- **docs/PHASE1_DEMO_REPORT.md**: Phase 1å®Ÿè£…æˆæœãƒ‡ãƒ¢

---

**ä½œæˆæ—¥**: 2026-02-16
**å¯¾è±¡ãƒãƒ¼ã‚¸ãƒ§ãƒ³**: Phase 1 (åŸºç›¤æ©Ÿèƒ½å®Ÿè£…å®Œäº†)
